# 2-ohtani-rag ä½¿ç”¨èªªæ˜Žæ›¸

æœ¬ç›®éŒ„åŒ…å«ä¸€å€‹è¤‡é›œçš„å¤šä»£ç†ç¨‹å¼ RAGï¼ˆæª¢ç´¢å¢žå¼·ç”Ÿæˆï¼‰ç³»çµ±ï¼Œå°ˆé–€ç”¨æ–¼å¤§è°·ç¿”å¹³ç›¸é—œçš„æ•¸æ“šæŸ¥è©¢ã€åˆ†æžå’Œæƒ…å ±è’é›†ã€‚ç³»çµ±æŽ¡ç”¨éšŽå±¤å¼æž¶æ§‹ï¼ŒåŒ…å«ä¸€å€‹ä¸»æŽ§åˆ¶ä»£ç†ç¨‹å¼å’Œäº”å€‹å°ˆæ¥­å­ä»£ç†ç¨‹å¼ï¼Œèƒ½å¤ å”åŒå·¥ä½œæä¾›å…¨é¢çš„é‹å‹•å“¡åˆ†æžå ±å‘Šã€‚

## ç³»çµ±æž¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                          Head Coach (Sequential)                                         â”‚
â”‚                                                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚  â”‚                      Reference Coach (Parallel)                     â”‚                                 â”‚
â”‚  â”‚                                                                     â”‚                                 â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                                 â”‚
â”‚  â”‚     â”‚                 Data Coach (Sequential)                 â”‚     â”‚                                 â”‚
â”‚  â”‚     â”‚                   â”Œâ”€>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚     â”‚                                 â”‚
â”‚  â”‚     â”‚                   â”‚        Query Coach (Loop)       â”‚   â”‚     â”‚                                 â”‚
â”‚  â”‚     â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚     â”‚   â”‚ Retrieval â”‚â”€â”€>â”‚  â”‚    SQL    â”‚â”€â”€>â”‚  Fetching â”‚  â”‚   â”‚     â”‚â”€â”€â”€>â”‚     Analytics Coach     â”‚  â”‚
â”‚  â”‚     â”‚   â”‚   Coach   â”‚   â”‚  â”‚   Coach   â”‚   â”‚   Coach   â”‚  â”‚   â”‚     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚     â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚     â”‚                                 â”‚
â”‚  â”‚     â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<â”€â”˜   â”‚     â”‚                                 â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                                 â”‚
â”‚  â”‚                                                                     â”‚                                 â”‚
â”‚  â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚                                 â”‚
â”‚  â”‚                 â”‚           Scout Coach           â”‚                 â”‚                                 â”‚
â”‚  â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚                                 â”‚
â”‚  â”‚                                                                     â”‚                                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ç›®éŒ„çµæ§‹

```
2-ohtani-rag/
â”œâ”€â”€ .env.example                     # ç’°å¢ƒè®Šæ•¸é…ç½®ç¯„ä¾‹
â”œâ”€â”€ README.md                        # æœ¬èªªæ˜Žæ–‡ä»¶
â””â”€â”€ head_coach_agent/                # ä¸»æŽ§åˆ¶ä»£ç†ç¨‹å¼
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ agent.py                     # ä¸»ä»£ç†ç¨‹å¼å®šç¾©
    â””â”€â”€ subagents/                   # å­ä»£ç†ç¨‹å¼ç›®éŒ„
        â”œâ”€â”€ __init__.py
        â”œâ”€â”€ analytics_coach_agent/   # åˆ†æžæ•™ç·´ä»£ç†ç¨‹å¼
        â”‚   â”œâ”€â”€ __init__.py
        â”‚   â””â”€â”€ agent.py
        â”œâ”€â”€ fetching_coach_agent/    # æ•¸æ“šæå–ä»£ç†ç¨‹å¼
        â”‚   â”œâ”€â”€ __init__.py
        â”‚   â”œâ”€â”€ agent.py
        â”‚   â””â”€â”€ tools.py
        â”œâ”€â”€ retrieval_coach_agent/   # æª¢ç´¢ä»£ç†ç¨‹å¼
        â”‚   â”œâ”€â”€ __init__.py
        â”‚   â”œâ”€â”€ agent.py
        â”‚   â””â”€â”€ tools.py
        â”œâ”€â”€ scout_coach_agent/       # æƒ…è’ä»£ç†ç¨‹å¼
        â”‚   â”œâ”€â”€ __init__.py
        â”‚   â””â”€â”€ agent.py
        â””â”€â”€ sql_coach_agent/         # SQL ç”Ÿæˆä»£ç†ç¨‹å¼
            â”œâ”€â”€ __init__.py
            â””â”€â”€ agent.py
```

## ç’°å¢ƒè¨­å®š

### 1. é…ç½®ç’°å¢ƒè®Šæ•¸

é¦–å…ˆï¼Œè¤‡è£½ `.env.example` æª”æ¡ˆä¸¦é‡æ–°å‘½åç‚º `.env`ï¼š

```bash
cp .env.example .env
```

ç„¶å¾Œæ ¹æ“šæ‚¨çš„éœ€æ±‚é¸æ“‡ä»¥ä¸‹å…¶ä¸­ä¸€ç¨®é…ç½®æ–¹å¼ï¼š

#### é¸é … 1: ä½¿ç”¨ Vertex AI
```env
GOOGLE_GENAI_USE_VERTEXAI=TRUE
GOOGLE_CLOUD_PROJECT=your-project-id
GOOGLE_CLOUD_LOCATION=us-east5
```

#### é¸é … 2: ä½¿ç”¨ Google AI API
```env
GOOGLE_GENAI_USE_VERTEXAI=FALSE
GOOGLE_API_KEY=your-api-key
```

âš ï¸ **é‡è¦æé†’**ï¼šè«‹å‹¿å°‡çœŸå¯¦çš„ API é‡‘é‘°æäº¤åˆ°ç‰ˆæœ¬æŽ§åˆ¶ç³»çµ±ä¸­ã€‚

### 2. å®‰è£ä¾è³´å¥—ä»¶

ç¢ºä¿æ‚¨å·²å®‰è£å¿…è¦çš„ Python å¥—ä»¶

## å•Ÿå‹•å’Œä½¿ç”¨æ–¹å¼

### 1. èº«ä»½é©—è­‰è¨­å®šï¼ˆåƒ…é™ Vertex AI ä½¿ç”¨è€…ï¼‰

å¦‚æžœæ‚¨åœ¨ç’°å¢ƒè¨­å®šä¸­é¸æ“‡äº†ã€ŒVertex AIã€ï¼Œå¿…é ˆå…ˆé€²è¡Œ Google Cloud èº«ä»½é©—è­‰ï¼š

```bash
gcloud auth application-default login
```

**æ³¨æ„**ï¼šå¦‚æžœæ‚¨ä½¿ç”¨çš„æ˜¯ã€ŒGoogle AI Studioã€ï¼Œè«‹è·³éŽæ­¤æ­¥é©Ÿã€‚

### 2. å•Ÿå‹• Dev UI

ä½¿ç”¨çµ‚ç«¯æ©Ÿå°Žèˆªåˆ° 2-ohtani-rag ç›®éŒ„ï¼š

```bash
cd 2-ohtani-rag
```

åŸ·è¡Œä»¥ä¸‹å‘½ä»¤å•Ÿå‹• Dev UIï¼š

```bash
adk web
```

### 3. é–‹å•Ÿç¶²é ä»‹é¢

åœ¨ç€è¦½å™¨ä¸­é–‹å•Ÿæä¾›çš„ URLï¼ˆé€šå¸¸æ˜¯ `http://localhost:8000`ï¼‰ï¼Œåœ¨å·¦ä¸Šè§’çš„ä¸‹æ‹‰é¸å–®ä¸­é¸æ“‡ `head_coach_agent`ã€‚

## ç³»çµ±åŠŸèƒ½ä»‹ç´¹

### ä¸»æŽ§åˆ¶ä»£ç†ç¨‹å¼

**Head Coach Agent** æ˜¯æ•´å€‹ç³»çµ±çš„æ ¸å¿ƒæŽ§åˆ¶å™¨ï¼ŒæŽ¡ç”¨ `SequentialAgent` æž¶æ§‹ï¼Œè² è²¬å”èª¿æ‰€æœ‰å­ä»£ç†ç¨‹å¼çš„å·¥ä½œæµç¨‹ã€‚

### å­ä»£ç†ç¨‹å¼è©³ç´°èªªæ˜Ž

#### 1. Reference Coach (Parallel Agent)

**åŠŸèƒ½**ï¼šä¸¦è¡ŒåŸ·è¡Œæ•¸æ“šæŸ¥è©¢å’Œæƒ…å ±è’é›†
- åŒæ™‚å•Ÿå‹• Data Coach å’Œ Scout Coach
- æé«˜ç³»çµ±æ•ˆçŽ‡ï¼Œæ¸›å°‘ç¸½é«”åŸ·è¡Œæ™‚é–“

#### 2. Data Coach (Sequential Agent)

**åŠŸèƒ½**ï¼šé †åºåŸ·è¡Œæ•¸æ“šæª¢ç´¢å’ŒæŸ¥è©¢æµç¨‹
- å…ˆåŸ·è¡Œ Retrieval Coach ç²å–è³‡æ–™åº«çµæ§‹
- å†åŸ·è¡Œ Query Coach é€²è¡Œæ•¸æ“šæŸ¥è©¢

#### 3. Query Coach (Loop Agent)

**åŠŸèƒ½**ï¼šå¾ªç’°åŸ·è¡Œ SQL ç”Ÿæˆå’Œæ•¸æ“šæå–
- æœ€å¤šåŸ·è¡Œ 3 æ¬¡è¿­ä»£
- åŒ…å« SQL Coach å’Œ Fetching Coach
- ç›´åˆ°ç²å¾—æ»¿æ„çš„æŸ¥è©¢çµæžœæˆ–é”åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•¸

#### 4. Retrieval Coach Agent

**æª”æ¡ˆä½ç½®**ï¼š`head_coach_agent/subagents/retrieval_coach_agent/agent.py`

**åŠŸèƒ½æè¿°**ï¼š
- å°ˆé–€è² è²¬æª¢ç´¢å’Œæä¾›è³‡æ–™åº« schema åŠ SQL æŸ¥è©¢ç¯„ä¾‹
- æ ¹æ“šä½¿ç”¨è€…å•é¡Œåˆ¤æ–·æ˜¯å¦èˆ‡å¤§è°·ç¿”å¹³ç›¸é—œ
- åˆå§‹åŒ–ç³»çµ±ç‹€æ…‹ä¸¦æä¾›è³‡æ–™åº«çµæ§‹è³‡è¨Š

**ä¸»è¦ç‰¹è‰²**ï¼š
- å…·å‚™ `retrieve_schema_and_example` å’Œ `set_default_review_feedback` å·¥å…·
- åš´æ ¼çš„ç›¸é—œæ€§åˆ¤æ–·æ©Ÿåˆ¶

**å·¥ä½œæµç¨‹**ï¼š
1. åˆå§‹åŒ– review_feedback ç‹€æ…‹
2. åˆ¤æ–·å•é¡Œæ˜¯å¦èˆ‡å¤§è°·ç¿”å¹³ç›¸é—œ
3. æª¢ç´¢ç›¸é—œçš„è³‡æ–™åº« schema å’ŒæŸ¥è©¢ç¯„ä¾‹
4. æŒ‰ç…§å›ºå®šæ ¼å¼è¼¸å‡ºçµæžœ

#### 5. SQL Coach Agent

**æª”æ¡ˆä½ç½®**ï¼š`head_coach_agent/subagents/sql_coach_agent/agent.py`

**åŠŸèƒ½æè¿°**ï¼š
- å°ˆé–€è² è²¬åˆ†æžä½¿ç”¨è€…å•é¡Œä¸¦ç”Ÿæˆå°æ‡‰ SQL æŸ¥è©¢
- æ ¹æ“šæª¢ç´¢åˆ°çš„è³‡æ–™åº« schema å’Œç¯„ä¾‹æ§‹å»ºç²¾ç¢ºçš„ SQL èªžå¥
- å…·å‚™éŒ¯èª¤å›žé¥‹æ©Ÿåˆ¶

**ä¸»è¦ç‰¹è‰²**ï¼š
- ç´” SQL è¼¸å‡ºï¼Œç„¡é¡å¤–èªªæ˜Žæ–‡å­—
- æ”¯æ´éŒ¯èª¤å›žé¥‹å’Œè¿­ä»£æ”¹é€²

**è¼¸å‡ºæ ¼å¼**ï¼š
- åªè¼¸å‡ºå¯ç›´æŽ¥åŸ·è¡Œçš„ SQL èªžå¥
- ä¸åŒ…å«ä»»ä½•è¨»è§£æˆ–èªªæ˜Ž
- ä¸ä½¿ç”¨ç¨‹å¼ç¢¼å€å¡Šæ¨™è¨˜

#### 6. Fetching Coach Agent

**æª”æ¡ˆä½ç½®**ï¼š`head_coach_agent/subagents/fetching_coach_agent/agent.py`

**åŠŸèƒ½æè¿°**ï¼š
- èƒ½å¤ åŸ·è¡Œ SQL èªžå¥æŸ¥è©¢ SQLite æ•¸æ“šåº«
- æ ¹æ“šæŸ¥è©¢çµæžœåˆ¤æ–·æ˜¯å¦ç¬¦åˆç”¨æˆ¶éœ€æ±‚
- æŽ§åˆ¶å¾ªç’°ä»£ç†ç¨‹å¼çš„é€€å‡ºæ¢ä»¶

**ä¸»è¦ç‰¹è‰²**ï¼š
- å…·å‚™ `execute_sql` å’Œ `exit_loop` å·¥å…·
- æ™ºèƒ½åˆ¤æ–·æŸ¥è©¢çµæžœæ˜¯å¦æ»¿è¶³éœ€æ±‚

**å·¥ä½œé‚è¼¯**ï¼š
1. åŸ·è¡Œ SQL æŸ¥è©¢
2. è©•ä¼°æŸ¥è©¢çµæžœæ˜¯å¦ç¬¦åˆéœ€æ±‚
3. æ±ºå®šæ˜¯å¦é€€å‡ºå¾ªç’°æˆ–ç¹¼çºŒè¿­ä»£

#### 7. Scout Coach Agent

**æª”æ¡ˆä½ç½®**ï¼š`head_coach_agent/subagents/scout_coach_agent/agent.py`

**åŠŸèƒ½æè¿°**ï¼š
- æƒ…è’æ•™ç·´ä»£ç†ï¼Œå°ˆé–€é€²è¡Œé‹å‹•å“¡ç›¸é—œçš„æƒ…å ±è’é›†èˆ‡ç¸½çµ
- ä½¿ç”¨ Google æœå°‹å·¥å…·ç²å–æœ€æ–°è³‡è¨Š
- æ™ºèƒ½åˆ¤æ–·æ˜¯å¦éœ€è¦ç¶²è·¯æŸ¥è©¢

**ä¸»è¦ç‰¹è‰²**ï¼š
- å…·å‚™ `google_search` å·¥å…·
- å°ˆæ³¨æ–¼é‹å‹•å“¡ç›¸é—œæƒ…å ±

**æŸ¥è©¢åŽŸå‰‡**ï¼š
- å¯æŸ¥è©¢ä»»ä½•é‹å‹•å“¡çš„ç›¸é—œè³‡è¨Š
- é è¨­æŸ¥è©¢å¤§è°·ç¿”å¹³ç›¸é—œè³‡è¨Š
- åªåœ¨éœ€è¦ç¶²è·¯è³‡æ–™æ™‚æ‰ä½¿ç”¨æœå°‹å·¥å…·

#### 8. Analytics Coach Agent

**æª”æ¡ˆä½ç½®**ï¼š`head_coach_agent/subagents/analytics_coach_agent/agent.py`

**åŠŸèƒ½æè¿°**ï¼š
- åˆ†æžæ•™ç·´ä»£ç†ï¼Œå°ˆé–€æ•´åˆæƒ…è’è³‡æ–™èˆ‡æ•¸æ“šåº«æŸ¥è©¢çµæžœ
- æä¾›ç¶œåˆæ€§çš„é‹å‹•å“¡åˆ†æžå ±å‘Š
- çµåˆå®šé‡æ•¸æ“šèˆ‡å®šæ€§æƒ…å ±

**ä¸»è¦ç‰¹è‰²**ï¼š
- æ•´åˆå¤šæ–¹é¢è³‡æ–™ä¾†æº
- å°ˆæ¥­çš„é‹å‹•åˆ†æžè§’åº¦

**åˆ†æžåŽŸå‰‡**ï¼š
1. **æ•¸æ“šå„ªå…ˆ**ï¼šä»¥æ•¸æ“šåº«çš„å¯¦éš›æ•¸æ“šç‚ºåˆ†æžåŸºç¤Ž
2. **æƒ…å ±è£œå¼·**ï¼šç”¨ç¶²è·¯æƒ…è’çš„è³‡è¨Šè£œå……å’Œé©—è­‰æ•¸æ“šåˆ†æž
3. **å…¨é¢æ•´åˆ**ï¼šå°‡å®šé‡æ•¸æ“šèˆ‡å®šæ€§æƒ…å ±ç›¸çµåˆ
4. **å°ˆæ¥­å‘ˆç¾**ï¼šç”¨å°ˆæ¥­çš„é‹å‹•åˆ†æžè§’åº¦ä¾†è§£è®€å’Œå‘ˆç¾çµæžœ

## ä½¿ç”¨ç¯„ä¾‹

**å•é¡Œ**ï¼šã€Œå¤§è°·ç¿”å¹³æœ€è¿‘çš„æ‰“æ“Šè¡¨ç¾å¦‚ä½•ï¼Ÿã€

**ç³»çµ±åŸ·è¡Œæµç¨‹**ï¼š
1. **Reference Coach** ä¸¦è¡Œå•Ÿå‹•æ•¸æ“šæŸ¥è©¢å’Œæƒ…å ±è’é›†
2. **Retrieval Coach** æª¢ç´¢ç›¸é—œçš„è³‡æ–™åº« schema å’ŒæŸ¥è©¢ç¯„ä¾‹
3. **SQL Coach** ç”ŸæˆæŸ¥è©¢å¤§è°·ç¿”å¹³æœ€è¿‘æ‰“æ“Šæ•¸æ“šçš„ SQL èªžå¥
4. **Fetching Coach** åŸ·è¡Œ SQL æŸ¥è©¢ä¸¦ç²å–æ•¸æ“š
5. **Scout Coach** åŒæ™‚æœå°‹ç¶²è·¯ä¸Šé—œæ–¼å¤§è°·ç¿”å¹³æœ€æ–°è¡¨ç¾çš„è³‡è¨Š
6. **Analytics Coach** æ•´åˆæ•¸æ“šåº«æ•¸æ“šå’Œç¶²è·¯æƒ…å ±ï¼Œæä¾›ç¶œåˆåˆ†æžå ±å‘Š

## ç³»çµ±ç‰¹è‰²

### 1. æ™ºèƒ½ç›¸é—œæ€§åˆ¤æ–·
- æ‰€æœ‰ä»£ç†ç¨‹å¼éƒ½å…·å‚™æ™ºèƒ½åˆ¤æ–·æ©Ÿåˆ¶
- èƒ½è­˜åˆ¥èˆ‡å¤§è°·ç¿”å¹³æˆ–é‹å‹•å“¡ç›¸é—œçš„å•é¡Œ
- å°ä¸ç›¸é—œå•é¡Œæœƒé©ç•¶æ‹’çµ•æˆ–å¼•å°Ž

### 2. å¤šå±¤æ¬¡æž¶æ§‹è¨­è¨ˆ
- **Sequential**ï¼šç¢ºä¿å·¥ä½œæµç¨‹çš„é †åºæ€§
- **Parallel**ï¼šæé«˜ç³»çµ±åŸ·è¡Œæ•ˆçŽ‡
- **Loop**ï¼šæ”¯æ´è¿­ä»£æ”¹é€²å’ŒéŒ¯èª¤ä¿®æ­£

### 3. éŒ¯èª¤è™•ç†å’Œå›žé¥‹æ©Ÿåˆ¶
- SQL æŸ¥è©¢å¤±æ•—æ™‚æœƒé€²è¡Œè¿­ä»£æ”¹é€²
- å…·å‚™ review_feedback æ©Ÿåˆ¶è¨˜éŒ„å’Œå­¸ç¿’éŒ¯èª¤
- æ™ºèƒ½åˆ¤æ–·æŸ¥è©¢çµæžœæ˜¯å¦æ»¿è¶³éœ€æ±‚

### 4. å¤šæ¨¡æ…‹è³‡æ–™æ•´åˆ
- çµåˆçµæ§‹åŒ–æ•¸æ“šåº«è³‡æ–™
- æ•´åˆéžçµæ§‹åŒ–ç¶²è·¯æƒ…å ±
- æä¾›å…¨é¢çš„åˆ†æžè¦–è§’

## æŠ€è¡“æž¶æ§‹èªªæ˜Ž

### ä»£ç†ç¨‹å¼é¡žåž‹

1. **SequentialAgent**ï¼šæŒ‰é †åºåŸ·è¡Œå­ä»£ç†ç¨‹å¼
2. **ParallelAgent**ï¼šä¸¦è¡ŒåŸ·è¡Œå­ä»£ç†ç¨‹å¼
3. **LoopAgent**ï¼šå¾ªç’°åŸ·è¡Œå­ä»£ç†ç¨‹å¼ï¼Œæ”¯æ´è¿­ä»£æ”¹é€²
4. **LlmAgent**ï¼šåŸºæ–¼å¤§èªžè¨€æ¨¡åž‹çš„å–®ä¸€ä»£ç†ç¨‹å¼

### ç‹€æ…‹ç®¡ç†æ©Ÿåˆ¶

ADK æä¾›äº†å¼·å¤§çš„ç‹€æ…‹ç®¡ç†æ©Ÿåˆ¶ï¼Œè®“ä»£ç†ç¨‹å¼ä¹‹é–“èƒ½å¤ æœ‰æ•ˆåœ°å…±äº«è³‡è¨Šå’Œç‹€æ…‹ï¼š

#### **ç‹€æ…‹è¨­ç½®èˆ‡è®€å–**
- **å·¥å…·ä¸­çš„ç‹€æ…‹æ“ä½œ**ï¼šåœ¨å·¥å…·å‡½æ•¸ä¸­ï¼Œå¯ä»¥é€éŽ `tool_context.state` ä¾†è¨­ç½®æˆ–è®€å–ç‹€æ…‹
- **ä»£ç†ç¨‹å¼è¼¸å‡ºç‹€æ…‹**ï¼šä»£ç†ç¨‹å¼çš„ `output_key` ä¹Ÿæ˜¯ç‹€æ…‹è¨­ç½®çš„ä¸€ç¨®æ–¹å¼
- **è·¨ä»£ç†ç¨‹å¼å…±äº«**ï¼šé€éŽç‹€æ…‹æ©Ÿåˆ¶ï¼Œä¸åŒä»£ç†ç¨‹å¼å¯ä»¥å…±äº«è³‡è¨Šå’ŒåŸ·è¡Œç‹€æ…‹

#### **ç‹€æ…‹å‚³éžæµç¨‹**
1. **ç‹€æ…‹è¨­å®šæˆ–æ›´æ–°**ï¼šå„ä»£ç†ç¨‹å¼åœ¨åŸ·è¡ŒéŽç¨‹ä¸­å»ºç«‹æˆ–æ›´æ–°ç›¸é—œç‹€æ…‹è³‡è¨Š
2. **ç‹€æ…‹è®€å–**ï¼šå¾ŒçºŒä»£ç†ç¨‹å¼å¯ä»¥è®€å–å‰é¢è¨­ç½®çš„ç‹€æ…‹ï¼Œå¯¦ç¾è³‡è¨Šå‚³éž
3. **éŒ¯èª¤å›žé¥‹**ï¼šä¾‹å¦‚ SQL æŸ¥è©¢å¤±æ•—æ™‚ï¼ŒéŒ¯èª¤è³‡è¨Šæœƒè¨˜éŒ„åˆ°ç‹€æ…‹ä¸­ä¾›å¾ŒçºŒè¿­ä»£ä½¿ç”¨

#### **å¯¦éš›æ‡‰ç”¨ç¯„ä¾‹**
- **review_feedback ç‹€æ…‹**ï¼šè¨˜éŒ„ SQL æŸ¥è©¢çš„éŒ¯èª¤è³‡è¨Šï¼Œä¾› SQL Coach æ”¹é€²æŸ¥è©¢
- **æŸ¥è©¢çµæžœç‹€æ…‹**ï¼šFetching Coach çš„æŸ¥è©¢çµæžœå¯ä»¥è¢« Analytics Coach è®€å–
- **æƒ…å ±è³‡æ–™ç‹€æ…‹**ï¼šScout Coach çš„æœå°‹çµæžœé€éŽç‹€æ…‹å‚³éžçµ¦ Analytics Coach

### æ¨¡åž‹ä½¿ç”¨

- **gemini-2.5-flash**ï¼šç”¨æ–¼è¤‡é›œçš„æª¢ç´¢å’Œ SQL ç”Ÿæˆä»»å‹™
- **gemini-2.5-flash-lite**ï¼šç”¨æ–¼åˆ†æžå’Œæƒ…å ±è’é›†ä»»å‹™
- **æ¨¡åž‹æ“´å±•æ€§**ï¼šé™¤äº†ä½¿ç”¨ Gemini æ¨¡åž‹ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥é€éŽ LiteLLM æ•´åˆå…¶ä»–æ¨¡åž‹ï¼ˆå¦‚ GPTã€Claude ç­‰ï¼‰
  - ðŸ“– è©³ç´°æ•™å­¸ï¼š[LiteLLM èˆ‡ Google ADK æ•´åˆæŒ‡å—](https://docs.litellm.ai/docs/tutorials/google_adk)

### å·¥å…·æ•´åˆ

- **retrieve_schema_and_example**ï¼šæª¢ç´¢è³‡æ–™åº«çµæ§‹å’Œç¯„ä¾‹
- **set_default_review_feedback**ï¼šåˆå§‹åŒ–å›žé¥‹æ©Ÿåˆ¶
- **execute_sql**ï¼šåŸ·è¡Œ SQL æŸ¥è©¢
- **exit_loop**ï¼šæŽ§åˆ¶å¾ªç’°é€€å‡º
- **google_search**ï¼šç¶²è·¯æœå°‹åŠŸèƒ½

## å¸¸è¦‹å•é¡Œ

### Q: ç³»çµ±åªèƒ½æŸ¥è©¢å¤§è°·ç¿”å¹³çš„è³‡æ–™å—Žï¼Ÿ
A: 
- **æ•¸æ“šåº«æŸ¥è©¢**ï¼šè³‡æ–™åº«åƒ…æä¾›å¤§è°·ç¿”å¹³çš„æ•¸æ“š
- **æƒ…å ±è’é›†**ï¼šScout Coach å¯ä»¥æŸ¥è©¢ä»»ä½•é‹å‹•å“¡çš„è³‡è¨Š
- **åˆ†æžåŠŸèƒ½**ï¼šAnalytics Coach å¯ä»¥åˆ†æžä»»ä½•é‹å‹•å“¡çš„æ•¸æ“š

### Q: å¦‚æžœ SQL æŸ¥è©¢å¤±æ•—æ€Žéº¼è¾¦ï¼Ÿ
A: 
- Query Coach æŽ¡ç”¨ Loop Agent æž¶æ§‹ï¼Œæœ€å¤šæœƒé€²è¡Œ 3 æ¬¡è¿­ä»£
- æ¯æ¬¡å¤±æ•—å¾Œæœƒè¨˜éŒ„éŒ¯èª¤è³‡è¨Šåˆ° review_feedback
- SQL Coach æœƒæ ¹æ“šéŒ¯èª¤å›žé¥‹æ”¹é€²æŸ¥è©¢èªžå¥

### Q: ç³»çµ±å¦‚ä½•åˆ¤æ–·æŸ¥è©¢çµæžœæ˜¯å¦æ»¿è¶³éœ€æ±‚ï¼Ÿ
A: 
- Fetching Coach æœƒåˆ†æžæŸ¥è©¢çµæžœçš„ CSV æ•¸æ“š
- æ ¹æ“šä½¿ç”¨è€…åŽŸå§‹å•é¡Œåˆ¤æ–·æ•¸æ“šæ˜¯å¦ç›¸é—œå’Œå®Œæ•´
- åªæœ‰åœ¨çµæžœæ»¿è¶³éœ€æ±‚æ™‚æ‰æœƒé€€å‡ºå¾ªç’°

### Q: ç¶²è·¯æœå°‹ä»€éº¼æ™‚å€™æœƒè¢«è§¸ç™¼ï¼Ÿ
A: 
- Scout Coach æœƒæ™ºèƒ½åˆ¤æ–·æ˜¯å¦éœ€è¦ç¶²è·¯æŸ¥è©¢
- åªæœ‰ç•¶å•é¡Œç¢ºå¯¦éœ€è¦æœ€æ–°è³‡è¨Šæˆ–å¤–éƒ¨æƒ…å ±æ™‚æ‰æœƒæœå°‹
- ç´”æ•¸æ“šåº«æŸ¥è©¢å•é¡Œä¸æœƒè§¸ç™¼ç¶²è·¯æœå°‹

## ä¸‹ä¸€æ­¥

å®Œæˆ 2-ohtani-rag çš„å­¸ç¿’å¾Œï¼Œæ‚¨å¯ä»¥ï¼š

1. æŽ¢ç´¢ `3-ohtani-mcp` ç›®éŒ„äº†è§£ MCPï¼ˆModel Context Protocolï¼‰æ‡‰ç”¨
2. å­¸ç¿’å¦‚ä½•å»ºç«‹è‡ªå·±çš„å¤šä»£ç†ç¨‹å¼ RAG ç³»çµ±
3. ç ”ç©¶å¦‚ä½•æ•´åˆä¸åŒé¡žåž‹çš„è³‡æ–™ä¾†æº
4. é–‹ç™¼é‡å°ç‰¹å®šé ˜åŸŸçš„å°ˆæ¥­åˆ†æžç³»çµ±
